{% extends 'base.html' %}
{% block content %}
<h2>Reservation Checkout</h2>
<form method="POST" action="/checkout" class="checkout-form-unified">
    <div class="checkout-main-card">
        <div class="car-header">
            <img src="{{ url_for('static', filename=car.image) }}" alt="{{ car.name }}" class="checkout-car-img-clean">
            <div>
                <div class="car-name-clean">{{ car.name }}</div>
                <div class="car-year-color-clean">{{ car.year }} &mdash; {{ car.color }}</div>
            </div>
        </div>
        <table class="summary-table">
            <tr><td class="summary-label">Rental Period:</td><td>{{ start_time_friendly }}<br>to {{ end_time_friendly }}</td></tr>
            <tr><td class="summary-label">Total Duration:</td><td>{{ duration_hours }} hour{{ 's' if duration_hours != 1 else '' }}</td></tr>
            <tr><td class="summary-label">Total Price:</td><td class="total-price-clean">${{ total_price }}</td></tr>
        </table>
        <div class="admin-warning-clean"><b>Note:</b> All reservations are subject to admin approval.</div>
        <div class="user-info-unified">
            <h4>Your Information</h4>
            <label>Name:</label>
            <div class="user-info-field">{{ user.name }}</div>
            <label>Email:</label>
            <div class="user-info-field">{{ user.email }}</div>
            <label>Phone:</label>
            <div class="user-info-field">{{ user.phone }}</div>
        </div>
        <div class="destination-section">
            <label for="destination">Where will you be going?</label>
            <select name="destination" id="destination" required>
                <option value="">Select a destination</option>
                <option value="Monsey">Monsey</option>
                <option value="Lakewood">Lakewood</option>
                <option value="Brooklyn">Brooklyn</option>
                <option value="Baltimore">Baltimore</option>
                <option value="Other">Other</option>
            </select>
            <input type="text" name="custom_destination" id="custom_destination" placeholder="Enter destination" style="display:none; margin-top:0.7em;" />
        </div>
        <div class="rishus-section-unified">
            <label>Do you have <b>Rishus</b> (permission) to rent the car?</label>
            <div>
                <input type="radio" id="rishus_yes" name="rishus" value="yes" required>
                <label for="rishus_yes">Yes</label>
                <input type="radio" id="rishus_no" name="rishus" value="no" required>
                <label for="rishus_no">No</label>
            </div>
        </div>
        <div class="checkout-actions-unified">
            <button type="submit" class="btn btn-large btn-primary-unified">Submit Reservation Request</button>
            <a href="/search" class="btn btn-secondary btn-cancel-unified">Cancel</a>
        </div>
    </div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    var destSelect = document.getElementById('destination');
    var customDest = document.getElementById('custom_destination');
    if (destSelect) {
        destSelect.addEventListener('change', function() {
            if (destSelect.value === 'Other') {
                customDest.style.display = 'block';
                customDest.required = true;
            } else {
                customDest.style.display = 'none';
                customDest.required = false;
            }
        });
    }
});
</script>
</form>
{% endblock %}
